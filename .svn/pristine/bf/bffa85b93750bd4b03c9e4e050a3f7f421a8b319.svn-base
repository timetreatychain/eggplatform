<template>
  <div class="inviteActivity">
    <div class="banner">
    </div>
    <p class="p1">
      TTC基金会为了奖励对TTC生态有贡献的社区成员，特推出开区分红奖励计划，只要参与游戏挖矿的社区成员每期成功邀请至少一名有效用户，即可参与分红。 （有效用户定义：完成KYC二级身份验证）
    </p>
    <div class="box">
      <p class="title" v-if="state4 == 0">你未获得本期矿池分红资格</p>
      <p class="title4" v-else>您已获得本期矿池分红资格</p>
      <p class="title2" v-if="state4 == 0">（至少一名邀请用户完成KYC二级认证即可参与）</p>
      <div class="box2">
        <p class="p1">邀请小伙伴加入矿池分红(人数越多，分红矿池奖励越高)</p>
        <p class="p2"><input type="text" v-model="link1"></p>
        <div class="box2_inner">
          <span class="copy1" v-clipboard:copy="link1" v-clipboard:success="onCopy" v-clipboard:error="onError"></span>
          <span class="poster" @click="showposter($event)"></span>
          <div class="info">
            <span>查询本期我的个人算力</span>
            <a href="http://block.liyugame.com/#/" class="gottc">前往生态浏览器官网》</a>
          </div>
        </div>
      </div>
    </div>
    <ul class="footer">
      <li><img src="../../common/img/activity/inviteActivity/dxm.png" alt="">
        <p>蛋小妹微信</p>
      </li>
      <li><img src="../../common/img/activity/inviteActivity/dxd.png" alt="">
        <p>蛋小弟微信</p>
      </li>
    </ul>
    <transition name="custom-classes-transition" enter-active-class="animated zoomIn" leave-active-class="animated zoomOut">
      <tc v-if="show" class="tc" v-on:hide="hide1" :link1="message" @hidett="haha"></tc>
    </transition>
    <transition name=" custom-classes-transition" enter-active-class="animated zoomIn " leave-active-class="animated zoomOut ">
      <tc2 v-if="show1 " class="tc1" :index0="cur" :url="url6" v-on:hide3="hide4"></tc2>
    </transition>
  </div>
</template>

<script>
import tc from "./tc";
import tc2 from "./tc2";
export default {
  data() {
    return {
      link1: "defbekjs,fnksldfjlskf.dfmksd",
      show: false,
      show1: false,
      cur: 0,
      url6: "",
      dataNum: {},
      message: "",
      show2: false,
      state4:""
    };
  },
  components: {
    tc,
    tc2
  },
  mounted () {
    this.getinit();
    this.getlink();
  },
  methods: {
    hide1(val) {
      console.log(val);
      this.show = val.show4;
      this.show1 = true;
      this.cur = val.index;
      this.url6 = val.url;
    },
    haha(val3) {
      this.show1 = val3;
      this.show = val3;
    },
    hide4() {
      this.show1 = false;
      document.documentElement.style.overflow = "scroll";
    },
    getinit() {
      let vm = this;
      	if(sessionStorage.egg_isLogin == 1) {
      $.ajax({
        type: "post",
        url: contextPath + "/api/eggworldTwoActivity/invitingactivities",
        async: true,
        dataType: "json",
        data: {
          token: sessionStorage.egg_token || 1
        },
        success(res) {
          if (res.state.code === "20000") {
            // vm.message = res.data.url;
            vm.state4 = res.data
          }
        }
      });
      }else {
					sessionStorage.egg_isLogin = 1
					this.$router.push({
						path: "/userNormal",
						query: {
							bakUrl: location.href
						}
					});
				}
    },
    getlink() {
      let vm = this;
      $.ajax({
        type: "post",
        url: contextPath + "/api/eggworldTwoActivity/findopenid",
        async: true,
        dataType: "json",
        data: {
          token: sessionStorage.egg_token || 1
        },
        success(res) {
          if (res.state.code === "20000") {
            vm.message = res.data.url;
            vm.link1 = res.data.url;
          }
        }
      });
    },
    showposter(e) {
      if (sessionStorage.egg_isLogin == 1) {
        this.show = true;
        document.documentElement.style.overflow = "hidden";
      } else {
        this.$router.push({
          path: "/userNormal",
          query: {
            bakUrl: location.href
          }
        });
      }
    },
    onCopy: function(e) {
      mui.alert("复制成功");
    },
    onError: function(e) {
      if (this.showlink) {
        console.log("无法复制文本！");
        mui.alert("复制失败");
      }
    }
  }
};
</script>

<style scoped lang="less">
.inviteActivity {
  background: #fcc01e;
  padding-bottom: 0.8rem;
  .tc {
    position: fixed;
    -webkit-overflow-scrolling: touch;
    top: 0;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.2);
    overflow: auto;
  }
  .banner {
    height: 4.3rem;
    background: url("../../common/img/activity/inviteActivity/bg.png") no-repeat;
    background-size: 100%;
  }
  .p1 {
    padding: 0.2rem;
    padding-top: 0rem;
    font-size: 0.2rem;
    color: #44433b;
    margin-bottom: 0;
  }
  .box {
    padding: 0.2rem;
    p {
      margin-bottom: 0;
    }
    .title {
      color: #fc4d1e;
      font-size: 0.3rem;
      font-weight: bold;
      text-align: center;
      line-height: 0.4rem;
    }
    .title4 {
      color: #44433b;
      font-size: 0.3rem;
      font-weight: bold;
      text-align: center;
      line-height: 0.4rem;
    }
    .title2 {
      text-align: center;
      line-height: 0.25rem;
      font-size: 0.18rem;
      color: #44433b;
      margin-bottom: 0.2rem;
    }
    .box2 {
      height: 3.75rem;
      background: url("../../common/img/activity/inviteActivity/border.png")
        no-repeat;
      background-size: 100%;
      padding: 0.2rem 0.1rem 0.2rem 0.45rem;
      overflow: hidden;
      .p1 {
        font-size: 0.2rem;
        color: #44433b;
        margin-top: 0.1rem;
      }
      .p2 {
        width: 5rem;
        margin-left: 0.2rem;
        display: block;
        outline: none;
        margin-bottom: 0.2rem;
        input {
          width: 100%;
          height: 100%;
          border: 0.01rem dotted #000;
          font-weight: 300;
          margin-bottom: 0.1rem;
          padding: 0;
          padding: 0.1rem;
          font-size: 0.2rem;

        }
      }
    }
    .box2_inner {
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
      width: 5rem;
      margin-left: 0.2rem;
      .copy1 {
        width: 1.52rem;
        height: 0.54rem;
        background: url("../../common/img/activity/inviteActivity/copy.png")
          no-repeat;
        background-size: 100%;
      }
      .poster {
        width: 3.39rem;
        height: 0.54rem;
        background: url("../../common/img/activity/inviteActivity/sc.png")
          no-repeat;
        background-size: 100%;
      }
      .info {
        width: 5.5rem;
        margin-top: 0.2rem;
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
        span {
          width: 2.39rem;
          height: 0.25rem;
          font-size: 0.2rem;
          color: #44433b;
          line-height: 0.25rem;
        }
        .gottc {
          color: #2ab1f0;
          font-size: 0.2rem;
          width: 2.5rem;
          line-height: 0.25rem;
        }
      }
    }
  }
  .footer {
    width: 3.2rem;
    background: #fcc01e;
    height: 1.3rem;
    display: flex;
    justify-content: space-between;
    flex-wrap: wrap;
    margin: 0.4rem auto 0rem;
    li {
      width: 1.25rem;
      height: 1.5rem;
      img {
        width: 1.25rem;
        height: 1.26rem;
      }
      p {
        margin-bottom: 0;
        text-align: center;
        line-height: 0.2rem;
        font-size: 0.2rem;
        color: #44433b;
      }
    }
  }
}
</style>